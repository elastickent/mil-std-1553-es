#!/usr/local/bin/bash
curl -k -XPUT "https://elastic:elastic@es.example.com:9200/_template/1553" -H 'Content-Type: application/json' -d'{  "index_patterns": [    "1553-*"  ],  "mappings": {    "properties": {       "Data": {        "type": "keyword"      },       "channel": {        "type": "keyword"      },      "T_R": {        "type": "keyword"      },      "Errs": {        "type": "integer"      },      "RT": {        "type": "integer"      },      "SA": {        "type": "integer"      },      "WC": {        "type": "integer"      },      "@timestamp": {        "type": "date"      }    }  }}'

curl -k  -XPUT "https://elastic:elastic@es.example.com:9200/_ingest/pipeline/1553" -H 'Content-Type: application/json' -d'{  "description": "parse 1553 output from idmp1553",  "processors": [    {      "dissect": {        "field": "message",        "pattern": "%{Time} %{channel_header} %{channel} %{RT} %{T_R} %{SA} %{WC->} %{Errs->} %{Data}",        "on_failure": [            {              "dissect": {                "field": "message",                "pattern": "%{Time} %{channel_header} %{channel} %{RT} %{T_R} %{SA} %{WC->} %{Errs}"              }            }          ]      }    },    {      "date": {        "field": "Time",        "target_field": "@timestamp",        "formats": [          "HH:mm:ss.SSSSSS"        ]      }    },    {      "convert": {        "field": "RT",        "type": "integer"      }    },    {      "convert": {        "field": "Errs",        "type": "integer"      }    },    {      "convert": {        "field": "WC",        "type": "integer"      }    },    {      "convert": {        "field": "SA",        "type": "integer"      }    }  ]}'
